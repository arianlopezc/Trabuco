spring:
  application:
    name: {{.ProjectName}}-event-consumer
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:local}
{{- if .UsesKafka}}

  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
    consumer:
      group-id: ${KAFKA_CONSUMER_GROUP:{{.ProjectName}}-consumers}
      auto-offset-reset: earliest
      enable-auto-commit: false
    producer:
      # Producer config for DLT (Dead Letter Topic) publishing
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer

app:
  kafka:
    topics:
      placeholder-events: ${KAFKA_TOPIC_PLACEHOLDER:placeholder-events}
{{- else if .UsesRabbitMQ}}

  rabbitmq:
    host: ${RABBITMQ_HOST:localhost}
    port: ${RABBITMQ_PORT:5672}
    username: ${RABBITMQ_USERNAME:guest}
    password: ${RABBITMQ_PASSWORD:guest}
    virtual-host: ${RABBITMQ_VHOST:/}

app:
  rabbitmq:
    queues:
      placeholder-events: ${RABBITMQ_QUEUE_PLACEHOLDER:placeholder-events}
    exchanges:
      placeholder: ${RABBITMQ_EXCHANGE_PLACEHOLDER:placeholder-exchange}
{{- else if .UsesSQS}}

  cloud:
    aws:
      region:
        static: ${AWS_REGION:us-east-1}
      credentials:
        access-key: ${AWS_ACCESS_KEY_ID:test}
        secret-key: ${AWS_SECRET_ACCESS_KEY:test}
      sqs:
        endpoint: ${SQS_ENDPOINT:http://localhost:4566}
        listener:
          # Don't fail on startup if queue doesn't exist - useful for testing
          queue-not-found-strategy: ${SQS_QUEUE_NOT_FOUND_STRATEGY:fail}

app:
  sqs:
    queue:
      placeholder-events: ${SQS_QUEUE_PLACEHOLDER:placeholder-events}
{{- else if .UsesPubSub}}

  cloud:
    gcp:
      project-id: ${GCP_PROJECT_ID:local-project}
      pubsub:
        emulator-host: ${PUBSUB_EMULATOR_HOST:localhost:8085}

app:
  pubsub:
    subscription:
      placeholder-events: ${PUBSUB_SUBSCRIPTION_PLACEHOLDER:placeholder-events-sub}
    topic:
      placeholder-events: ${PUBSUB_TOPIC_PLACEHOLDER:placeholder-events}
{{- end}}

server:
  port: ${SERVER_PORT:8083}

management:
  server:
    port: ${MANAGEMENT_PORT:8084}
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when_authorized

logging:
  level:
    {{.GroupID}}: ${LOG_LEVEL:DEBUG}
{{- if .UsesKafka}}
    org.apache.kafka: WARN
    org.springframework.kafka: INFO
{{- else if .UsesRabbitMQ}}
    org.springframework.amqp: INFO
{{- else if .UsesSQS}}
    io.awspring.cloud: INFO
    software.amazon.awssdk: WARN
{{- else if .UsesPubSub}}
    com.google.cloud: INFO
    org.springframework.integration: INFO
{{- end}}
